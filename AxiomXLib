-- MATRIX UI HUB ULTRA PRO
-- By: Voc√™ üòé

-- Services
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UIS = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local UserGameSettings = UserSettings():GetService("UserGameSettings")
local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera

-- Vari√°veis globais
local ScreenGui, Main, ScrollFrame
local espEnabled = false
local espMode = "Name"
local espObjects = {}
local espFolder
local speed = 16
local jump = 50
local infJump = false
local noclip = false
local savedCFrames = {}
local connections = {}
local isMinimized = false
local originalSize = UDim2.fromScale(0.35, 0.6)
local minimizedSize = UDim2.fromScale(0.35, 0.08)
local isFPSBoosted = false
local originalGraphicsLevel
local playerGray = false
local originalPlayerColor
local fpsCounterEnabled = false
local fpsLabel
local originalAspectRatio
local stretchAmount = 0.65
local stretchEnabled = false

-- Configura√ß√£o global para stretch
_G.MetodeEstique = "0.65"  -- Valor padr√£o

-- ================= FUN√á√ïES UTILIT√ÅRIAS =================
local function createTween(object, properties, duration, easingStyle, easingDirection)
    local tweenInfo = TweenInfo.new(
        duration or 0.3,
        easingStyle or Enum.EasingStyle.Quad,
        easingDirection or Enum.EasingDirection.Out
    )
    local tween = TweenService:Create(object, tweenInfo, properties)
    tween:Play()
    return tween
end

local function showNotification(text, duration)
    local notif = Instance.new("TextLabel")
    notif.Size = UDim2.new(0, 300, 0, 40)
    notif.Position = UDim2.new(0.5, -150, 0.1, 0)
    notif.BackgroundColor3 = Color3.fromRGB(0, 20, 0)
    notif.BackgroundTransparency = 0.3
    notif.TextColor3 = Color3.fromRGB(0, 255, 0)
    notif.Text = text
    notif.Font = Enum.Font.Code
    notif.TextSize = 16
    notif.TextStrokeTransparency = 0.7
    notif.Parent = ScreenGui
    notif.ZIndex = 100
    
    local corner = Instance.new("UICorner", notif)
    corner.CornerRadius = UDim.new(0, 6)
    
    local stroke = Instance.new("UIStroke", notif)
    stroke.Color = Color3.fromRGB(0, 255, 0)
    stroke.Thickness = 1
    
    spawn(function()
        wait(duration or 3)
        createTween(notif, {Position = UDim2.new(0.5, -150, 0, -50)}, 0.5)
        wait(0.5)
        notif:Destroy()
    end)
end

-- ================= FPS COUNTER =================
local function toggleFPSCounter()
    fpsCounterEnabled = not fpsCounterEnabled
    
    if fpsCounterEnabled then
        -- Criar FPS Counter
        fpsLabel = Instance.new("TextLabel")
        fpsLabel.Name = "MatrixFPSCounter"
        fpsLabel.Size = UDim2.new(0, 150, 0, 35)
        fpsLabel.Position = UDim2.new(0, 10, 0, 10)
        fpsLabel.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
        fpsLabel.BackgroundTransparency = 0.4
        fpsLabel.TextColor3 = Color3.fromRGB(0, 255, 0)
        fpsLabel.Font = Enum.Font.Code
        fpsLabel.TextSize = 14
        fpsLabel.TextStrokeTransparency = 0.7
        fpsLabel.TextXAlignment = Enum.TextXAlignment.Left
        fpsLabel.Text = "FPS: 0 | PING: 0ms"
        fpsLabel.Parent = ScreenGui
        fpsLabel.Visible = true
        
        local corner = Instance.new("UICorner", fpsLabel)
        corner.CornerRadius = UDim.new(0, 6)
        
        local stroke = Instance.new("UIStroke", fpsLabel)
        stroke.Color = Color3.fromRGB(0, 255, 0)
        stroke.Thickness = 1
        
        -- Atualizar FPS e PING
        local frames = 0
        local lastTime = tick()
        local fps = 0
        
        local fpsConnection = RunService.RenderStepped:Connect(function()
            frames = frames + 1
            local currentTime = tick()
            if currentTime - lastTime >= 0.5 then
                fps = math.floor(frames / (currentTime - lastTime))
                frames = 0
                lastTime = currentTime
                
                -- Calcular PING (aproximado)
                local ping = math.random(20, 80)  -- Placeholder, pode ser substitu√≠do por Stats API
                
                -- Atualizar texto com cores baseadas no FPS
                fpsLabel.Text = string.format("FPS: %d | PING: %dms", fps, ping)
                
                -- Mudar cor baseado no FPS
                if fps >= 60 then
                    fpsLabel.TextColor3 = Color3.fromRGB(0, 255, 0)  -- Verde
                    stroke.Color = Color3.fromRGB(0, 255, 0)
                elseif fps >= 30 then
                    fpsLabel.TextColor3 = Color3.fromRGB(255, 255, 0)  -- Amarelo
                    stroke.Color = Color3.fromRGB(255, 255, 0)
                else
                    fpsLabel.TextColor3 = Color3.fromRGB(255, 50, 50)  -- Vermelho
                    stroke.Color = Color3.fromRGB(255, 50, 50)
                end
            end
        end)
        
        table.insert(connections, fpsConnection)
        showNotification("üìä FPS Counter ATIVADO", 2)
    else
        -- Remover FPS Counter
        if fpsLabel and fpsLabel.Parent then
            fpsLabel:Destroy()
            fpsLabel = nil
        end
        showNotification("üìä FPS Counter DESATIVADO", 2)
    end
end

-- ================= STRETCHER (ESTICADOR DE TELA) =================
local function applyStretch(amount)
    if typeof(amount) == "string" then
        amount = tonumber(amount)
    end
    
    if not amount or amount < -0.1 or amount > 10.5 then
        showNotification("‚ùå Valor inv√°lido! Use: -0.1 at√© 10.5", 3)
        return
    end
    
    stretchAmount = amount
    _G.MetodeEstique = tostring(amount)
    
    -- Aplicar o stretch
    local viewportSize = workspace.CurrentCamera.ViewportSize
    
    -- Calcular novo FieldOfView baseado no stretch
    local defaultFOV = 70
    local stretchedFOV = defaultFOV * (1 + (amount * 0.1))
    
    -- Aplicar ao Camera
    Camera.FieldOfView = stretchedFOV
    
    -- Se amount for 0.65 (padr√£o), usar configura√ß√£o especial
    if amount == 0.65 then
        Camera.FieldOfView = 80  -- Valor ideal para 0.65
    elseif amount >= 1.0 then
        -- Para valores altos, aplicar efeito fisheye
        Camera.FieldOfView = math.min(120, 70 + (amount * 5))
    elseif amount <= 0 then
        -- Para valores negativos, zoom in
        Camera.FieldOfView = math.max(30, 70 + (amount * 20))
    end
    
    -- Aplicar tamb√©m ao PlayerGui se existir
    local playerGui = LocalPlayer:FindFirstChild("PlayerGui")
    if playerGui then
        -- Ajustar ScreenGuis se necess√°rio
        for _, gui in pairs(playerGui:GetChildren()) do
            if gui:IsA("ScreenGui") then
                -- N√£o modificar nossa pr√≥pria UI
                if gui.Name ~= "MatrixHubUltraPro" then
                    -- Ajustar scaling se o gui tiver
                    if gui:FindFirstChild("Scaling") then
                        gui.Scaling = math.clamp(1 / (1 + (amount * 0.1)), 0.5, 2)
                    end
                end
            end
        end
    end
    
    showNotification(string.format("üñ•Ô∏è Stretch aplicado: %.2f (FOV: %.0f)", amount, Camera.FieldOfView), 3)
    
    -- Salvar prefer√™ncia
    pcall(function()
        local DataStoreService = game:GetService("DataStoreService")
        local stretchStore = DataStoreService:GetDataStore("MatrixStretchSettings")
        stretchStore:SetAsync(LocalPlayer.UserId .. "_stretch", amount)
    end)
    
    return amount
end

local function toggleStretch()
    stretchEnabled = not stretchEnabled
    
    if stretchEnabled then
        -- Aplicar stretch atual
        applyStretch(stretchAmount)
        showNotification("üñ•Ô∏è Stretch ATIVADO", 2)
    else
        -- Restaurar configura√ß√µes padr√£o
        Camera.FieldOfView = 70
        _G.MetodeEstique = "0"
        
        -- Restaurar PlayerGui
        local playerGui = LocalPlayer:FindFirstChild("PlayerGui")
        if playerGui then
            for _, gui in pairs(playerGui:GetChildren()) do
                if gui:IsA("ScreenGui") and gui:FindFirstChild("Scaling") then
                    gui.Scaling = 1
                end
            end
        end
        
        showNotification("üñ•Ô∏è Stretch DESATIVADO", 2)
    end
end

-- Interface para ajustar stretch
local function createStretchUI()
    local stretchUI = Instance.new("ScreenGui", ScreenGui)
    stretchUI.Name = "StretchAdjustUI"
    stretchUI.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    
    local mainFrame = Instance.new("Frame", stretchUI)
    mainFrame.Size = UDim2.fromScale(0.25, 0.25)
    mainFrame.Position = UDim2.fromScale(0.375, 0.375)
    mainFrame.BackgroundColor3 = Color3.fromRGB(5, 15, 5)
    mainFrame.BackgroundTransparency = 0.1
    
    local corner = Instance.new("UICorner", mainFrame)
    corner.CornerRadius = UDim.new(0, 8)
    
    local stroke = Instance.new("UIStroke", mainFrame)
    stroke.Color = Color3.fromRGB(0, 255, 0)
    stroke.Thickness = 2
    
    -- T√≠tulo
    local title = Instance.new("TextLabel", mainFrame)
    title.Size = UDim2.new(1, 0, 0.2, 0)
    title.BackgroundTransparency = 1
    title.Text = "üéÆ STRETCH ADJUSTER"
    title.TextColor3 = Color3.fromRGB(0, 255, 0)
    title.Font = Enum.Font.Code
    title.TextSize = 18
    
    -- Slider
    local sliderFrame = Instance.new("Frame", mainFrame)
    sliderFrame.Size = UDim2.new(0.9, 0, 0.15, 0)
    sliderFrame.Position = UDim2.new(0.05, 0, 0.3, 0)
    sliderFrame.BackgroundColor3 = Color3.fromRGB(20, 40, 20)
    
    local sliderCorner = Instance.new("UICorner", sliderFrame)
    sliderCorner.CornerRadius = UDim.new(0, 4)
    
    local sliderFill = Instance.new("Frame", sliderFrame)
    sliderFill.Size = UDim2.new((stretchAmount + 0.1) / 10.6, 0, 1, 0)
    sliderFill.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
    sliderFill.BorderSizePixel = 0
    
    local fillCorner = Instance.new("UICorner", sliderFill)
    fillCorner.CornerRadius = UDim.new(0, 4)
    
    local sliderValue = Instance.new("TextLabel", mainFrame)
    sliderValue.Size = UDim2.new(1, 0, 0.15, 0)
    sliderValue.Position = UDim2.new(0, 0, 0.5, 0)
    sliderValue.BackgroundTransparency = 1
    sliderValue.Text = string.format("Valor: %.2f", stretchAmount)
    sliderValue.TextColor3 = Color3.fromRGB(0, 255, 0)
    sliderValue.Font = Enum.Font.Code
    sliderValue.TextSize = 16
    
    -- Bot√µes de preset
    local presets = {
        {"-0.1", "Ultra Zoom"},
        {"0.65", "Padr√£o"},
        {"1.0", "Leve"},
        {"3.0", "M√©dio"},
        {"5.0", "Forte"},
        {"10.5", "Extremo"}
    }
    
    local yPos = 0.7
    for i, preset in ipairs(presets) do
        local btn = Instance.new("TextButton", mainFrame)
        btn.Size = UDim2.new(0.4, 0, 0.1, 0)
        btn.Position = UDim2.new(0.05 + ((i-1) % 2) * 0.5, 0, yPos + math.floor((i-1)/2) * 0.12, 0)
        btn.BackgroundColor3 = Color3.fromRGB(30, 60, 30)
        btn.TextColor3 = Color3.fromRGB(0, 255, 0)
        btn.Text = preset[2] .. "\n" .. preset[1]
        btn.Font = Enum.Font.Code
        btn.TextSize = 12
        
        local btnCorner = Instance.new("UICorner", btn)
        btnCorner.CornerRadius = UDim.new(0, 4)
        
        btn.MouseButton1Click:Connect(function()
            applyStretch(tonumber(preset[1]))
            sliderValue.Text = string.format("Valor: %.2f", stretchAmount)
            sliderFill:TweenSize(
                UDim2.new((stretchAmount + 0.1) / 10.6, 0, 1, 0),
                Enum.EasingDirection.Out,
                Enum.EasingStyle.Quad,
                0.2
            )
        end)
    end
    
    -- Bot√£o de fechar
    local closeBtn = Instance.new("TextButton", mainFrame)
    closeBtn.Size = UDim2.new(0.9, 0, 0.1, 0)
    closeBtn.Position = UDim2.new(0.05, 0, 0.9, 0)
    closeBtn.BackgroundColor3 = Color3.fromRGB(60, 30, 30)
    closeBtn.TextColor3 = Color3.fromRGB(255, 100, 100)
    closeBtn.Text = "FECHAR"
    closeBtn.Font = Enum.Font.Code
    closeBtn.TextSize = 14
    
    local closeCorner = Instance.new("UICorner", closeBtn)
    closeCorner.CornerRadius = UDim.new(0, 4)
    
    closeBtn.MouseButton1Click:Connect(function()
        stretchUI:Destroy()
    end)
    
    -- Interatividade do slider
    local dragging = false
    sliderFrame.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
        end
    end)
    
    UIS.InputChanged:Connect(function(input)
        if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            local xPos = (input.Position.X - sliderFrame.AbsolutePosition.X) / sliderFrame.AbsoluteSize.X
            xPos = math.clamp(xPos, 0, 1)
            local newValue = (xPos * 10.6) - 0.1
            newValue = math.floor(newValue * 100) / 100  -- Arredondar para 2 casas
            
            applyStretch(newValue)
            sliderValue.Text = string.format("Valor: %.2f", newValue)
            sliderFill.Size = UDim2.new(xPos, 0, 1, 0)
        end
    end)
    
    UIS.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = false
        end
    end)
    
    return stretchUI
end

-- ================= PLAYER CINZA =================
local function togglePlayerGray()
    playerGray = not playerGray
    
    if LocalPlayer.Character then
        local character = LocalPlayer.Character
        
        if playerGray then
            originalPlayerColor = {}
            
            for _, part in pairs(character:GetChildren()) do
                if part:IsA("BasePart") then
                    originalPlayerColor[part] = part.Color
                    part.Color = Color3.fromRGB(128, 128, 128)
                    part.Material = Enum.Material.Plastic
                end
            end
            
            showNotification("üé® Player CINZA ativado", 2)
        else
            if originalPlayerColor then
                for part, color in pairs(originalPlayerColor) do
                    if part and part.Parent then
                        part.Color = color
                    end
                end
            end
            showNotification("üé® Player CORES normais", 2)
        end
    end
end

-- ================= SAVE POSITION COM SETCLIPBOARD =================
local function savePosition(name)
    if not name or name == "" then
        name = "Position_" .. #savedCFrames + 1
    end
    
    if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
        local cf = LocalPlayer.Character.HumanoidRootPart.CFrame
        savedCFrames[name] = cf
        
        local scriptText = string.format([[
-- Teleport script for %s
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer

local function teleportToPosition()
    if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
        LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(%s, %s, %s)
        print("‚úÖ Teleported to saved position: %s")
    end
end

teleportToPosition()
]], name, cf.Position.X, cf.Position.Y, cf.Position.Z, name)
        
        if setclipboard then
            setclipboard(scriptText)
            showNotification("üìã Script copiado: " .. name, 3)
        else
            print("\nüìã Script para posi√ß√£o '" .. name .. "':\n")
            print(scriptText)
            showNotification("üìã Script no console: " .. name, 3)
        end
        
        return scriptText
    end
    return nil
end

-- ================= UI =================
local function createUI()
    if ScreenGui and ScreenGui.Parent then
        ScreenGui:Destroy()
    end
    
    ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "MatrixHubUltraPro"
    ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    ScreenGui.Parent = game:GetService("CoreGui") or game.Players.LocalPlayer:WaitForChild("PlayerGui")
    
    -- Toggle de visibilidade com F9
    UIS.InputBegan:Connect(function(input, processed)
        if not processed and input.KeyCode == Enum.KeyCode.F9 then
            Main.Visible = not Main.Visible
        elseif not processed and input.KeyCode == Enum.KeyCode.F6 then
            toggleFPSCounter()
        elseif not processed and input.KeyCode == Enum.KeyCode.F5 then
            if ScreenGui:FindFirstChild("StretchAdjustUI") then
                ScreenGui:FindFirstChild("StretchAdjustUI"):Destroy()
            else
                createStretchUI()
            end
        end
    end)
    
    Main = Instance.new("Frame")
    Main.Size = originalSize
    Main.Position = UDim2.fromScale(0.33, 0.2)
    Main.BackgroundColor3 = Color3.fromRGB(5, 10, 5)
    Main.BackgroundTransparency = 0.1
    Main.BorderSizePixel = 0
    Main.Active = true
    Main.Draggable = true
    Main.Parent = ScreenGui
    
    -- Efeito de glow
    local UICorner = Instance.new("UICorner", Main)
    UICorner.CornerRadius = UDim.new(0, 8)
    
    local Stroke = Instance.new("UIStroke", Main)
    Stroke.Color = Color3.fromRGB(0, 255, 0)
    Stroke.Thickness = 1.5
    Stroke.Transparency = 0.7
    
    -- Efeito de pulso na borda
    spawn(function()
        while Main and Main.Parent do
            createTween(Stroke, {Thickness = 2.5}, 1, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut)
            task.wait(1)
            createTween(Stroke, {Thickness = 1.5}, 1, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut)
            task.wait(1)
        end
    end)
    
    -- T√≠tulo com bot√µes de controle
    local TitleBar = Instance.new("Frame", Main)
    TitleBar.Size = UDim2.new(1, 0, 0.07, 0)
    TitleBar.BackgroundTransparency = 1
    TitleBar.Name = "TitleBar"
    
    local Title = Instance.new("TextLabel", TitleBar)
    Title.Size = UDim2.new(0.6, 0, 1, 0)
    Title.BackgroundTransparency = 1
    Title.Text = "‚ö° MATRIX HUB PRO ‚ö°"
    Title.TextColor3 = Color3.fromRGB(0, 255, 0)
    Title.Font = Enum.Font.Code
    Title.TextScaled = true
    Title.TextStrokeTransparency = 0.7
    
    -- Bot√µes de controle
    local controlButtons = {
        {text = "-", x = 0.7, color = Color3.fromRGB(30, 60, 30), func = function()
            isMinimized = not isMinimized
            Main.Size = isMinimized and minimizedSize or originalSize
        end},
        {text = "+", x = 0.79, color = Color3.fromRGB(30, 60, 30), func = function()
            Main.Size = UDim2.fromScale(0.45, 0.8)
            Main.Position = UDim2.fromScale(0.275, 0.1)
        end},
        {text = "X", x = 0.88, color = Color3.fromRGB(60, 30, 30), func = function()
            ScreenGui:Destroy()
        end}
    }
    
    for _, btnInfo in pairs(controlButtons) do
        local btn = Instance.new("TextButton", TitleBar)
        btn.Size = UDim2.new(0.08, 0, 0.7, 0)
        btn.Position = UDim2.new(btnInfo.x, 0, 0.15, 0)
        btn.BackgroundColor3 = btnInfo.color
        btn.TextColor3 = Color3.fromRGB(0, 255, 0)
        btn.Text = btnInfo.text
        btn.Font = Enum.Font.Code
        btn.TextScaled = true
        
        local btnCorner = Instance.new("UICorner", btn)
        btnCorner.CornerRadius = UDim.new(0, 4)
        
        btn.MouseButton1Click:Connect(btnInfo.func)
    end
    
    -- Subtitle
    local subtitle = Instance.new("TextLabel", Main)
    subtitle.Size = UDim2.new(1, 0, 0.04, 0)
    subtitle.Position = UDim2.new(0, 0, 0.07, 0)
    subtitle.BackgroundTransparency = 1
    subtitle.Text = "F9: UI | F6: FPS | F5: Stretch"
    subtitle.TextColor3 = Color3.fromRGB(0, 200, 0)
    subtitle.Font = Enum.Font.Code
    subtitle.TextScaled = true
    subtitle.TextTransparency = 0.5
    
    -- Container de bot√µes com scroll
    ScrollFrame = Instance.new("ScrollingFrame", Main)
    ScrollFrame.Size = UDim2.new(1, 0, 0.89, 0)
    ScrollFrame.Position = UDim2.new(0, 0, 0.11, 0)
    ScrollFrame.BackgroundTransparency = 1
    ScrollFrame.BorderSizePixel = 0
    ScrollFrame.ScrollBarThickness = 4
    ScrollFrame.ScrollBarImageColor3 = Color3.fromRGB(0, 150, 0)
    ScrollFrame.ScrollingDirection = Enum.ScrollingDirection.Y
    ScrollFrame.VerticalScrollBarPosition = Enum.VerticalScrollBarPosition.Left
    
    local UIListLayout = Instance.new("UIListLayout", ScrollFrame)
    UIListLayout.Padding = UDim.new(0, 5)
    UIListLayout.SortOrder = Enum.SortOrder.LayoutOrder
    
    return ScrollFrame
end

-- ================= BUTTON MAKER =================
local function createButton(text, parent)
    local btn = Instance.new("TextButton", parent)
    btn.Size = UDim2.new(0.9, 0, 0, 40)
    btn.Position = UDim2.new(0.05, 0, 0, 0)
    btn.BackgroundColor3 = Color3.fromRGB(10, 30, 10)
    btn.BackgroundTransparency = 0.2
    btn.TextColor3 = Color3.fromRGB(0, 255, 0)
    btn.Text = text
    btn.Font = Enum.Font.Code
    btn.TextScaled = true
    btn.AutoButtonColor = true
    
    local UICorner = Instance.new("UICorner", btn)
    UICorner.CornerRadius = UDim.new(0, 6)
    
    local UIStroke = Instance.new("UIStroke", btn)
    UIStroke.Color = Color3.fromRGB(0, 150, 0)
    UIStroke.Thickness = 1
    
    btn.MouseEnter:Connect(function()
        createTween(btn, {BackgroundColor3 = Color3.fromRGB(20, 50, 20)}, 0.2)
        createTween(UIStroke, {Thickness = 2}, 0.2)
    end)
    
    btn.MouseLeave:Connect(function()
        createTween(btn, {BackgroundColor3 = Color3.fromRGB(10, 30, 10)}, 0.2)
        createTween(UIStroke, {Thickness = 1}, 0.2)
    end)
    
    return btn
end

-- ================= SCRIPT INITIALIZATION =================
local function initialize()
    local ScrollFrame = createUI()
    
    -- Criar se√ß√µes
    local function createSection(title)
        local section = Instance.new("TextLabel", ScrollFrame)
        section.Size = UDim2.new(0.9, 0, 0, 25)
        section.Position = UDim2.new(0.05, 0, 0, 0)
        section.BackgroundTransparency = 1
        section.Text = "‚îÄ‚îÄ‚îÄ " .. title .. " ‚îÄ‚îÄ‚îÄ"
        section.TextColor3 = Color3.fromRGB(0, 255, 150)
        section.Font = Enum.Font.Code
        section.TextSize = 14
        section.TextXAlignment = Enum.TextXAlignment.Center
        return section
    end
    
    -- Se√ß√£o: VISUAL
    createSection("VISUAL")
    
    local fpsCounterBtn = createButton("üìä FPS Counter: OFF", ScrollFrame)
    fpsCounterBtn.MouseButton1Click:Connect(function()
        toggleFPSCounter()
        fpsCounterBtn.Text = fpsCounterEnabled and "üìä FPS Counter: ON" or "üìä FPS Counter: OFF"
    end)
    
    local stretchBtn = createButton("üñ•Ô∏è Stretch: OFF", ScrollFrame)
    stretchBtn.MouseButton1Click:Connect(function()
        toggleStretch()
        stretchBtn.Text = stretchEnabled and string.format("üñ•Ô∏è Stretch: %.2f", stretchAmount) or "üñ•Ô∏è Stretch: OFF"
    end)
    
    local stretchAdjustBtn = createButton("üéÆ Ajustar Stretch", ScrollFrame)
    stretchAdjustBtn.MouseButton1Click:Connect(function()
        if ScreenGui:FindFirstChild("StretchAdjustUI") then
            ScreenGui:FindFirstChild("StretchAdjustUI"):Destroy()
        else
            createStretchUI()
        end
    end)
    
    local grayBtn = createButton("üé® Player Cinza: OFF", ScrollFrame)
    grayBtn.MouseButton1Click:Connect(function()
        togglePlayerGray()
        grayBtn.Text = playerGray and "üé® Player Cinza: ON" or "üé® Player Cinza: OFF"
    end)
    
    -- Se√ß√£o: MOVIMENTO
    createSection("MOVIMENTO")
    
    local speedBtn = createButton("üèÉ Speed: " .. speed, ScrollFrame)
    speedBtn.MouseButton1Click:Connect(function()
        speed = speed + 10
        if speed > 100 then speed = 16 end
        if LocalPlayer.Character then
            local humanoid = LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
            if humanoid then humanoid.WalkSpeed = speed end
        end
        speedBtn.Text = "üèÉ Speed: " .. speed
    end)
    
    local noclipBtn = createButton("üëª Noclip: OFF", ScrollFrame)
    noclipBtn.MouseButton1Click:Connect(function()
        noclip = not noclip
        noclipBtn.Text = noclip and "üëª Noclip: ON" or "üëª Noclip: OFF"
    end)
    
    -- Se√ß√£o: POSI√á√ïES
    createSection("POSI√á√ïES")
    
    local savePosBtn = createButton("üíæ Save Position (Clipboard)", ScrollFrame)
    savePosBtn.MouseButton1Click:Connect(function()
        savePosition("Position_" .. os.time())
    end)
    
    local customSaveBtn = createButton("üìù Save as 'Base'", ScrollFrame)
    customSaveBtn.MouseButton1Click:Connect(function()
        savePosition("Base")
    end)
    
    -- Se√ß√£o: UTILIDADES
    createSection("UTILIDADES")
    
    local resetBtn = createButton("üîÑ Reset Settings", ScrollFrame)
    resetBtn.MouseButton1Click:Connect(function()
        speed = 16
        jump = 50
        noclip = false
        playerGray = false
        stretchEnabled = false
        Camera.FieldOfView = 70
        speedBtn.Text = "üèÉ Speed: " .. speed
        noclipBtn.Text = "üëª Noclip: OFF"
        grayBtn.Text = "üé® Player Cinza: OFF"
        stretchBtn.Text = "üñ•Ô∏è Stretch: OFF"
        showNotification("üîÑ Todas as configura√ß√µes resetadas!", 3)
    end)
    
    -- Configurar noclip
    local noclipConnection
    noclipConnection = RunService.Stepped:Connect(function()
        if noclip and LocalPlayer.Character then
            for _, part in pairs(LocalPlayer.Character:GetDescendants()) do
                if part:IsA("BasePart") then
                    part.CanCollide = false
                end
            end
        end
    end)
    table.insert(connections, noclipConnection)
    
    -- Atualizar tamanho do ScrollFrame
    local function updateScrollSize()
        local totalHeight = 0
        for _, child in pairs(ScrollFrame:GetChildren()) do
            if child:IsA("GuiObject") and child.Visible then
                totalHeight = totalHeight + child.AbsoluteSize.Y + UIListLayout.Padding.Offset
            end
        end
        ScrollFrame.CanvasSize = UDim2.new(0, 0, 0, totalHeight)
    end
    
    UIListLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(updateScrollSize)
    updateScrollSize()
    
    -- Carregar stretch salvo
    pcall(function()
        local DataStoreService = game:GetService("DataStoreService")
        local stretchStore = DataStoreService:GetDataStore("MatrixStretchSettings")
        local savedStretch = stretchStore:GetAsync(LocalPlayer.UserId .. "_stretch")
        if savedStretch then
            stretchAmount = savedStretch
            _G.MetodeEstique = tostring(savedStretch)
        end
    end)
    
    print("‚ö° Matrix Hub Ultra PRO carregado!")
    print("üéÆ F6: Toggle FPS Counter")
    print("üñ•Ô∏è F5: Abrir Stretch Adjuster")
    print("üìã _G.MetodeEstique = " .. _G.MetodeEstique)
end

-- Inicializar
if LocalPlayer then
    initialize()
else
    Players.PlayerAdded:Wait()
    initialize()
end

-- Cleanup function
local function cleanup()
    for _, connection in pairs(connections) do
        pcall(function() connection:Disconnect() end)
    end
    if ScreenGui then
        ScreenGui:Destroy()
    end
    Camera.FieldOfView = 70
end

game:BindToClose(cleanup)
